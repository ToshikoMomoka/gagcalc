       const fruitPriceData = {
    "Carrot": [
        { kg: 0.22, value: 18 },
        { kg: 0.37, value: 36 },
        { kg: 1.53, value: 619 },
    ],

    "Tomato": [
        { kg: 0.42, value: 27 },
        { kg: 0.65, value: 51 },
        { kg: 0.70, value: 58 },
    ],

    "Strawberry": [
        { kg: 0.25, value: 14 },
        { kg: 0.41, value: 27 },
        { kg: 1.59, value: 423 },
    ],

    "Blueberry": [
        { kg: 0.17, value: 18 },
        { kg: 0.22, value: 24 },
    ],

    "Orange Tulip": [
        { kg: 0.06, value: 1068 },
    ],

    "Daffodil": [
        { kg: 0.18, value: 903 },
        { kg: 0.28, value: 1891 },
        { kg: 0.85, value: 18216 },
    ],

    "Coconut": [
        { kg: 19.56, value: 781 },
        { kg: 54.38, value: 6034 },
        { kg: 71.79, value: 10519 },
    ],

    "Bamboo": [
        { kg: 2.88, value: 3610 },
        { kg: 4.33, value: 4683 },
        { kg: 4.88, value: 5944 },
    ],


    "Candy Blossom": [
        { kg: 4.13, value: 189888 },
    ],

    "Easter Egg": [
        { kg: 3.24, value: 2921 },
        { kg: 6.02, value: 3548216, stack: ["Celestial", "Shocked", "Disco", "Frozen"] },
    ],

    "Apple": [
        { kg: 2.44, value: 248 },
    ],

    "Pepper": [
        { kg: 6.18, value: 12222 },
        { kg: 26.92, value: 1071674884, growth: "Golden", stack: ["Celestial", "Shocked", "Bloodlit", "Frozen"] },
    ],

    "Grape": [
        { kg: 3.53, value: 10875 },
        { kg: 11.49, value: 230442, stack: ["Wet"] },
        { kg: 11.87, value: 1229141, stack: ["Frozen"] },
    ],

    "Moon Mango": [
        { kg: 13.44, value: 45125 },
    ],

    "Mushroom": [
        { kg: 23.45, value: 136278 },
        { kg: 18.35, value: 545110, stack: ["Bloodlit"] },
        { kg: 31.58, value: 481741, stack: ["Wet"] },
        { kg: 34.15, value: 563519, stack: ["Wet"] },
    ],

    "Pineapple": [
        { kg: 9.49, value: 20022 },
    ],

    "Glowshroom": [
        { kg: 0.55, value: 271 },
        { kg: 0.98, value: 512 },
    ],

    "Eggplant": [
        { kg: 5.77, value: 9988 },
    ],

    "Moon Melon": [
        { kg: 7.22, value: 16245 },
        { kg: 9.54, value: 51237, stack: ["Wet"] },
    ],

    "Starfruit": [
        { kg: 3.20, value: 17109 },
    ],

    "Lilac": [
        { kg: 2.54, value: 31588 },
    ],

    "Cacao": [
        { kg: 7.48, value: 9928 },
        { kg: 24.00, value: 216000 },
        { kg: 31.01, value: 360561, stack: ["Wet"] },
    ],

    "Purple Dahila": [
        { kg: 17.03, value: 150964 },
        { kg: 20.18, value: 211295 },
    ],

    "Pink Lily": [
        { kg: 5.72, value: 59034 },
    ],

    "Rose": [
        { kg: 0.96, value: 4570 },
    ],
    
    "Moonglow": [
        { kg: 5.40, value: 18050 },
    ],

    "Peach": [
        { kg: 2.51, value: 471 },
    ],

    "Lotus": [
        { kg: 19.78, value: 16628 },
    ],

    "Venus Fly Trap": [
        { kg: 8.94, value: 22564 },
    ],

    "Nectarine": [
        { kg: 2.12, value: 31588 },
    ],

    "Moon Blossom": [
        { kg: 2.71, value: 54150 },
    ],

    "Hive Fruit": [
        { kg: 10.12, value: 80011 },
        { kg: 12.47, value: 121485 },
    ],

    "Durian": [
        { kg: 7.81, value: 6668 },
    ],

    "Sunflower": [
        { kg: 18.65, value: 896383800, growth: "Golden", stack: ["Pollinated", "Celestial", "Shocked", "Honey Glazed", "Frozen"] },
        { kg: 21.25, value: 248842 },
        { kg: 20.10, value: 445057, stack: ["Wet"] },
    ],

    "Celestiberry": [
        { kg: 1.52, value: 9025 },
        { kg: 2.47, value: 153017, stack: ["Frozen"] },
        { kg: 7.88, value: 1001145139, growth: "Rainbow", stack: ["Celestial", "Frozen"] },
        { kg: 9.31, value: 216574 },
        { kg: 15.16, value: 574640 },
    ],

    "Ember Lily": [
        { kg: 25.56, value: 252047 },
        { kg: 30.35, value: 710642, stack: ["Chilled"] },
    ],

    "Blood Banana": [
        { kg: 1.91, value: 9677 },
        { kg: 9.81, value: 90835844, stack: ["Pollinated", "Celestial", "Shocked", "Disco", "Frozen"] },
    ],

    "Manuka Flower": [
        { kg: 0.25, value: 22563 },
    ],

    "Honeysuckle": [
        { kg: 43.76, value: 1329696 },
    ],

    "Foxglove": [
        { kg: 7.74, value: 2995380, stack: ["Frozen"] },
        { kg: 10.01, value: 501301 },
    ],

    "Dragon Fruit": [
        { kg: 30.42, value: 305246, stack: ["Frozen"] },
    ],

    "Watermelon": [
        { kg: 9.15, value: 5125 },
    ],

    "Pumpkin": [
        { kg: 10.54, value: 5906 },
    ],

    "Mango": [
        { kg: 47.52, value: 15656509, growth: ["Golden"], stack: ["Pollinated", "Frozen"] },
        { kg: 43.92, value: 668708,  stack: ["Pollinated", "Frozen"] },
    ],

    "Beanstalk": [
        { kg: 9.48, value: 25270 },
        { kg: 9.48, value: 10092248, stack: ["Pollinated", "Celestial", "Shocked", "Disco", "Choc", "Heavenly", "Frozen"] },
    ]
        };

        const growthMuts = { "None": 1, "Golden": 19, "Rainbow": 49 };
        const stackMuts = {
            "Wet": 1, "Chilled": 1, "Chocolate": 1, "Moonlit": 1, "Bloodlit": 3, "Pollinated": 2,
            "Honey Glazed": 4, "Heavenly": 4, "Plasma": 4, "Frozen": 9, "Zombified": 24,
            "Shocked": 99, "Celestial": 119, "Disco": 124, "Void Touch": 134, "Dawnbound": 149
        };

        const scalingNumber = 2.05;

        function calcBasePrice(value, kg) {
            return value / Math.pow(kg, scalingNumber);
        }

        function calcFruitValueAfterSize(base, kg) {
            return base * Math.pow(kg, scalingNumber);
        }

        function estimateBase(fruitName) {
            const entries = fruitPriceData[fruitName];
            const baseEstimates = entries.map(e => {
                const growthMult = e.growth && growthMuts[e.growth] ? growthMuts[e.growth] : 1;
                const stackList = e.stack || [];
                let stackMult = 1;
                stackList.forEach(mut => {
                    const mult = stackMuts[mut];
                    if (!mult) console.warn(`${mut} is not a stackable mutation`);
                    stackMult += mult || 0;
                });
                const adjustedValue = e.value / (growthMult * stackMult);
                return calcBasePrice(adjustedValue, e.kg);
            });
            return baseEstimates.reduce((a, b) => a + b, 0) / baseEstimates.length;
        }

        function calcRawNumbers(base, kg, growth, stack) {
            return calcFruitValueAfterSize(base, kg) * growth * stack;
        }

        const growthMutsElm = document.querySelector(".growth");
        const fruitsElm = document.querySelector(".fruit");
        const mutationsElm = document.querySelector(".mutations");
        const weightElm = document.querySelector(".kg");
        const priceElm = document.querySelector(".price");
        const upperElm = document.querySelector(".upper");

        function sanitize(name) {
            return name.toLowerCase().replaceAll(" ", "-");
        }

        Object.keys(stackMuts).forEach(mutation => {
            const container = document.createElement("span");

            const inp = document.createElement("input");
            inp.type = "checkbox";
            inp.name = mutation;
            inp.id = sanitize(mutation);

            const label = document.createElement("label");
            label.innerHTML = ` ${mutation} <i>(+${stackMuts[mutation]})</i>`;
            label.setAttribute("for", inp.id);

            container.appendChild(inp);
            container.appendChild(label);
            mutationsElm.appendChild(container);
        });

        Object.keys(growthMuts).forEach(growth => {
            const opt = document.createElement("option");
            opt.innerText = `${growth} (${growthMuts[growth]}x)`;
            opt.value = growth;
            growthMutsElm.appendChild(opt);
        });

        Object.keys(fruitPriceData).sort().forEach(fruit => {
            const opt = document.createElement("option");
            opt.innerText = fruit;
            opt.value = fruit;
            fruitsElm.appendChild(opt);
        });

        function update() {
            priceElm.innerText = "?";
            const growthKey = growthMutsElm.value;
            const fruit = fruitsElm.value;
            const kg = parseFloat(weightElm.value);
            if (!fruit || isNaN(kg)) return;

            const growth = growthMuts[growthKey] || 1;
            const enabledMuts = Object.keys(stackMuts).filter(mut =>
                document.getElementById(sanitize(mut)).checked
            );

            let stacked = 1;
            enabledMuts.forEach(mut => {
                stacked += stackMuts[mut];
            });

            const base = estimateBase(fruit);
            const finalPrice = calcRawNumbers(base, kg, growth, stacked);

            priceElm.innerText = Math.floor(finalPrice).toLocaleString();
            upperElm.innerText = "Final Price:";
        }

        document.getElementById("calc-button").addEventListener("click", update);